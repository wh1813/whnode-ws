<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ•°å­¦æ›²çº¿ä¹‹ç¾</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: #0f0c29;
      background: linear-gradient(to right, #24243e, #302b63, #0f0c29);
      color: white;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 {
      margin: 20px 0;
      font-size: 2.5em;
      text-align: center;
      text-shadow: 0 0 10px #ff7ed4, 0 0 20px #ff7ed4;
    }
    .controls {
      margin: 15px 0;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    select, button {
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      border-radius: 30px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      backdrop-filter: blur(5px);
      outline: none;
      cursor: pointer;
      transition: 0.3s;
    }
    select:hover, button:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    canvas {
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      margin-top: 10px;
      box-shadow: 0 0 20px rgba(255, 126, 212, 0.3);
    }
    .footer {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9em;
      color: #aaa;
    }
  </style>
</head>
<body>
  <h1>âœ¨ æ•°å­¦æ›²çº¿ä¹‹ç¾ âœ¨</h1>
  <div class="controls">
    <select id="curveSelect">
      <option value="heart">å¿ƒå½¢çº¿ï¼ˆCardioidï¼‰</option>
      <option value="rose">ç«ç‘°çº¿ï¼ˆRose Curveï¼‰</option>
      <option value="spiral">é˜¿åŸºç±³å¾·èºæ—‹</option>
      <option value="lemniscate">ä¼¯åŠªåˆ©åŒçº½çº¿</option>
      <option value="epicycloid">å¤–æ‘†çº¿</option>
    </select>
    <button id="playBtn">â–¶ æ’­æ”¾</button>
    <button id="clearBtn">ğŸ—‘ æ¸…é™¤</button>
  </div>
  <canvas id="curveCanvas" width="700" height="600"></canvas>
  <div class="footer">
    ä½¿ç”¨å‚æ•°æ–¹ç¨‹ä¸æåæ ‡ | æ•°å­¦æ˜¯å®‡å®™çš„è¯­è¨€ ğŸŒŒ
  </div>

  <script>
    const canvas = document.getElementById('curveCanvas');
    const ctx = canvas.getContext('2d');
    const curveSelect = document.getElementById('curveSelect');
    const playBtn = document.getElementById('playBtn');
    const clearBtn = document.getElementById('clearBtn');

    // è®¾ç½® canvas åˆ†è¾¨ç‡é€‚é…é«˜æ¸…å±
    const dpr = window.devicePixelRatio || 1;
    canvas.width = canvas.clientWidth * dpr;
    canvas.height = canvas.clientHeight * dpr;
    ctx.scale(dpr, dpr);

    const centerX = canvas.clientWidth / 2;
    const centerY = canvas.clientHeight / 2;
    let t = 0;
    let animationId = null;
    let currentCurve = 'heart';

    // æ›²çº¿å‡½æ•°å®šä¹‰ï¼ˆè¿”å› [x, y] åæ ‡ï¼‰
    const curves = {
      heart: (t) => {
        // å¿ƒå½¢çº¿ï¼ˆå‚æ•°æ–¹ç¨‹ï¼‰
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
        return [x * 8, y * 8]; // ç¼©æ”¾
      },
      rose: (t) => {
        // ç«ç‘°çº¿ r = a * cos(kÎ¸)ï¼Œè¿™é‡Œ k=5
        const k = 5;
        const r = 100 * Math.cos(k * t);
        const x = r * Math.cos(t);
        const y = r * Math.sin(t);
        return [x, -y];
      },
      spiral: (t) => {
        // é˜¿åŸºç±³å¾·èºæ—‹ r = a + bÎ¸
        const a = 0, b = 10;
        const r = a + b * t;
        const x = r * Math.cos(t);
        const y = r * Math.sin(t);
        return [x, -y];
      },
      lemniscate: (t) => {
        // ä¼¯åŠªåˆ©åŒçº½çº¿ rÂ² = aÂ² cos(2Î¸)
        const a = 100;
        const r = a * Math.sqrt(Math.max(0, Math.cos(2 * t)));
        const x = r * Math.cos(t);
        const y = r * Math.sin(t);
        return [x, -y];
      },
      epicycloid: (t) => {
        // å¤–æ‘†çº¿ R=50, r=15
        const R = 50, r = 15;
        const x = (R + r) * Math.cos(t) - r * Math.cos((R / r + 1) * t);
        const y = (R + r) * Math.sin(t) - r * Math.sin((R / r + 1) * t);
        return [x, -y];
      }
    };

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.clientWidth, canvas.clientHeight);
    }

    function drawCurve(step = 0.02) {
      if (t > 2 * Math.PI * (currentCurve === 'spiral' ? 6 : 1)) {
        cancelAnimationFrame(animationId);
        return;
      }

      const [dx, dy] = curves[currentCurve](t);
      const x = centerX + dx;
      const y = centerY + dy;

      ctx.beginPath();
      ctx.moveTo(prevX || x, prevY || y);
      ctx.lineTo(x, y);
      ctx.strokeStyle = '#ff7ed4';
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.stroke();

      prevX = x;
      prevY = y;
      t += step;

      animationId = requestAnimationFrame(() => drawCurve(step));
    }

    let prevX, prevY;

    playBtn.addEventListener('click', () => {
      if (animationId) return; // é˜²æ­¢é‡å¤æ’­æ”¾
      currentCurve = curveSelect.value;
      clearCanvas();
      t = 0;
      prevX = null;
      prevY = null;
      drawCurve(currentCurve === 'spiral' ? 0.1 : 0.02);
    });

    clearBtn.addEventListener('click', () => {
      if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
      }
      clearCanvas();
      t = 0;
      prevX = null;
      prevY = null;
    });

    // åˆå§‹åŒ–æ˜¾ç¤ºå¿ƒå½¢çº¿
    curveSelect.value = 'heart';
  </script>
</body>
</html>
